<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Img Demo</title>
    <link href="reset.css" rel="stylesheet">
    <style>
    </style>
  </head>

  <body>

<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script> -->
<!-- <script src='jquery/jquery-1.9.1.js'></script> -->
<script src='jquery/jquery.min.js'></script>
<script src='thing.js'></script>

<script type="text/javascript">
var imgNames = [
  'elvis_eye_left_round.png',
  'elvis_eye_left_square.png',
  'elvis_eye_right_round.png',
  'elvis_eye_right_square.png',
  'elvis_mouth_round.png',
  'elvis_mouth_square.png',
  'marilyn_eye_left_fuzzy.png',
  'marilyn_eye_left_round.png',
  'marilyn_eye_left_square.png',
  'marilyn_eye_right_fuzzy.png',
  'marilyn_eye_right_round.png',
  'marilyn_eye_right_square.png',
  'marilyn_mouth.png',
  'marilyn_mouth_round.png',
  'marilyn_mouth_square.png',
  'mona_eye_left_circle.png',
  'mona_eye_left_fuzzy.png',
  'mona_eye_right_circle.png',
  'mona_eye_right_fuzzy.png',
  'mona_eye_right_square.png',
  'washington_eye_left_fuzzy.png',
  'washington_eye_left_round.png',
  'washington_eye_left_square.png',
  'washington_eye_right_fuzzy.png',
  'washington_eye_right_round.png',
  'washington_eye_right_square.png',
  'washington_mouth_fuzzy.png',
  'washington_mouth_round.png',
  'washington_mouth_square.png',
  'yoda_eye_left_fuzzy.png',
  'yoda_eye_right.png',
  'yoda_eye_right_fuzzy.png',
  'yoda_left_eye.png',
  'yoda_mouth_circle.png'
];

var imgNamesEyesRight = [
  'elvis_eye_right_round.png',
  'elvis_eye_right_square.png',
  'marilyn_eye_right_fuzzy.png',
  'marilyn_eye_right_round.png',
  'marilyn_eye_right_square.png',
  'mona_eye_right_circle.png',
  'mona_eye_right_fuzzy.png',
  'mona_eye_right_square.png',
  'washington_eye_right_fuzzy.png',
  'washington_eye_right_round.png',
  'washington_eye_right_square.png',
  'yoda_eye_right.png',
  'yoda_eye_right_fuzzy.png'
];

var imgNamesEyesLeft = [
  'elvis_eye_left_round.png',
  'elvis_eye_left_square.png',
  'marilyn_eye_left_fuzzy.png',
  'marilyn_eye_left_round.png',
  'marilyn_eye_left_square.png',
  'mona_eye_left_circle.png',
  'mona_eye_left_fuzzy.png',
  'washington_eye_left_fuzzy.png',
  'washington_eye_left_round.png',
  'washington_eye_left_square.png',
  'yoda_eye_left_fuzzy.png',
  'yoda_left_eye.png'
];

var imgNamesMouths = [
  'elvis_mouth_round.png',
  'elvis_mouth_square.png',
  'marilyn_mouth.png',
  'marilyn_mouth_round.png',
  'marilyn_mouth_square.png',
  'washington_mouth_fuzzy.png',
  'washington_mouth_round.png',
  'washington_mouth_square.png',
  'yoda_mouth_circle.png'
];

var imgNamesNoses = [
  "elvis_nose.png",
  "elvis_nose_square.png",
  "marilyn_nose.png",
  "marilyn_nose_fuzzy.png",
  "mona_nose_fuzzy.png",
  "mona_nose_square.png",
  "nixon_nose.png",
  "nixon_nose_fuzzy.png",
  "washington_nose.png",
  "washington_nose_fuzzy.png",
  "yoda_nose.png",
  "yoda_nose_fuzzy.png"
];

//-----------------------
var Rand = Thing.classes.Rand;
var Box = Thing.classes.Box;

class ImageBunchBox extends Box {
  init (props) {
    this.initialize(props);
    this.type = 'Box';
    this.items = [];
    this.$element = Thing.makeElement(this.html(), this.props, this.type);
  }
}

function imgBunch (names, box) {
  for (var i=0; i < names.length; i++) {
    var facepart = Thing.classes.Img.make({
      src: 'img/faceparts/' + names[i],
      x: Rand.randNormal() * 100,
      y: Rand.randNormal() * 100,
      opacity: .5 + (Rand.randFloat()),
      scale: .5 + Rand.randFloat()
    });
    box.add(facepart);
  }
  box.render();
}

function pickImages (names, box) {
  var howMany = Rand.randInt(3,7);
  var dim = box.getDimensions();
  var midW = dim.w/2;
  var midH = dim.h/2;
  var scale = dim.w / 100;

  for (var i=0; i < howMany; i++) {
    var facepart = Thing.classes.Img.make({
      src: 'img/faceparts/' + Rand.randItem(names),
      x: midW + (Rand.randNormal() * midW),
      y: midH + (Rand.randNormal() * midH),
      opacity: .5 + Rand.randFloat(),
      scale: 1.5 + (Rand.randNormal() * scale)
    });
    box.add(facepart);
  }
  box.render();
}

function makeBoundingBox(box, color) {
  var elbounds = box.getElementBounds(); // bounds of all elements, relative to document
  var boxbounds = box.getBoundingBox();  // bounds of the box element
  var rect = Thing.make({
    x: elbounds.x-boxbounds.x, // position the rectangle relative to the box
    y: elbounds.y-boxbounds.y, 
    w: elbounds.w, 
    h: elbounds.h,
    zIndex: 0,
    border: '2px solid ' + color
  });
  box.add(rect);  // add the rect to the box
  rect.render();
  return rect;
}

$(function(){
  var eyeR = Thing.classes.Box.make({x:170, y:150, w:100, h:100, backgroundColor:'green'});
  var eyeL = Thing.classes.Box.make({x:430, y:150, w:150, h:100, backgroundColor:'red'});
  var nose = Thing.classes.Box.make({x:300, y:200, w:100, h:100, backgroundColor:'magenta'});
  var mouth = Thing.classes.Box.make({x:250, y:460, w:200, h:100, backgroundColor:'yellow'});
  window.Nose = nose;
  window.Mouth = mouth;

  pickImages(imgNamesMouths, mouth);
  pickImages(imgNamesNoses, nose);
  pickImages(imgNamesEyesLeft, eyeL);
  pickImages(imgNamesEyesRight, eyeR);

  Thing.classes.Img.onAllLoaded = function () {
    window.console.log('Make Bounding Box');
    makeBoundingBox(nose, '#F00');
    makeBoundingBox(mouth, '#0F0');
    makeBoundingBox(eyeR, '#F0F');
    makeBoundingBox(eyeL, '#FF0');
  }
});

</script>


  </body>
</html>
