
<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Thing Demo</title>
    <link href="reset.css" rel="stylesheet">
    <style>
      #demo {
        border: 1px dashed #ccc;
        /*height: 400px;*/
        position: relative;
      }

      /* Lines can be styled with normal css: */
      div.Line {
        height: 5px; /* Line width of 3 */
        background: #948C79; /* Black fill */
        opacity: 0.5;
        box-shadow: 0 0 8px #B99B7E;
        transition: transform 1s;
      }

      div.Line:hover {
        background: #C30;
        box-shadow: 0 0 8px #C30;
        opacity: 1;
      }

      div.Line.active {
        background: #666;
        box-shadow: 0 0 8px #666;
        opacity: 1;
      }

      .Thing {
        border-color: #F00;
      }
    </style>
  </head>

  <body>

  <div id="page">
    <div id='content'>
      <div id='controls'>
        <a href='#' id='rotate-lines'>Rotate Lines</a>
        | <a href='#' id='rotate-arrows'>Rotate Arrows</a>
      </div>
    </div>
  </div>

<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script> -->
<!-- <script src='jquery/jquery-1.9.1.js'></script> -->
<script src='jquery/jquery.min.js'></script>
<script src='thing.js'></script>

<script>
$(function(){
  var x1 = null, y1 = null;

  $('#rotate-lines').click(function(event){
    event.preventDefault();
    rotateLineThings();
  });

  $('#rotate-arrows').click(function(event){
    event.preventDefault();
    rotateArrowThings();
  });

  function rotateArrowThings() {
    var degrees = (Math.random() * 360) - 180;   // +- 180
    for (var i=0; i < arrows.length; i++) {
      arrows[i].rotate(degrees);
    }
  }

  function rotateLineThings() {
    var degrees = (Math.random() * 360) - 180;   // +- 180
    for (var i=0; i < funboxItems.length; i++) {
      funboxItems[i].rotate(degrees);
    }
  }

  function makeDemoBox (props) {
    let defaultProps = {
      display: 'inline-block',
      position: 'relative',
      margin: '20px',
      width: '200px',
      height: '200px',
      border: '2px dashed #eee'
    };
    props = $.extend({}, defaultProps, props);
    return Thing.classes.Box.make(props);
  }

  //---------------------------------------------------------

  var arrows = [];
  var Box = Thing.classes.Box;
  var Arrow = Thing.classes.Arrow;
  var Img = Thing.classes.Img;

  function makeBoxOfArrows () {
    makeDemoBox({
      position:'relative',
      maxWidth:'1240px', minWidth:'500px',
      width: 'auto', height:'auto'
    })
    .add( makeTenBoxes() )
    .each( box => {box.add(makeRandomArrow())} )
    .render();
  }

  //---------------------------------------------------------

  window.funboxItems = [];

  class FunBox extends Box {
    init (props) {
      props = $.extend({
        position: 'relative',
        border: '2px solid #ddd',
        borderRadius: '6px',
        margin: '10px',
        maxWidth:'1240px',
        minWidth:'500px',
        width: 'auto', height:'auto'
      }, props);

      super.init(props);
      this.type = 'FunBox';
      this.$element = Thing.makeElement(this.html(), this.props, this.type);
    }
  }

  //---------------------------------------------------------

  function makeRandomArrow() {
    let a = Thing.classes.Arrow.make({
      rotate: {z: (Math.random()*360)},
      scale: .2 + (Math.random()*4),
      x: (Math.random()*200),
      y: (Math.random()*200),
      color: ["red", "yellow", "green", "blue"][parseInt(Math.random()*4)]
    });
    arrows.push(a);
    return a;
  }

  function makeTenBoxes() {
    let boxes = [];
    for (var i=0; i < 10; i++) {
      boxes.push(makeDemoBox({
        overflow:'hidden',
        borderColor: '#ccc',
        position: 'relative'
      }));
    }
    return boxes;
  }

  function makeTenLines() {
    let lines = [];
    for (var j=0; j < 10; j++) {
      var a = Thing.classes.Line.make({
        x1: (Math.random()*100),
        y1: (Math.random()*200),
        x2: (100 + Math.random()*100),
        y2: (Math.random()*200),
        lineWidth: parseInt(1 + (Math.random()*3), 10),
        opacity: .1 + (Math.random()*.9)
      });
      funboxItems.push(a);
      lines.push(a);
    }
    return lines;
  }

  function makeGradientMask() {
    var demobox = makeDemoBox({
      backgroundColor: '#69ffff',
      overflow:'hidden',
      borderColor: '#ccc',
      position: 'relative',
      width: '820px',
      height: '320px',
      padding: '10px'
    });
    var b = Thing.classes.Box.make({
      w:800,
      h:300,
      border:'2px solid black'
    });
    var p = Thing.classes.Pattern.make({
      pattern:'none',
      backgroundSize: '50px 50px, 50px 50px',
      backgroundPosition: '-2px -2px, -2px -2px',
      backgroundImage: 'linear-gradient(rgba(60, 60, 60, 0.4) 2px, transparent 2px), linear-gradient(90deg, rgba(60, 60, 60, 0.4) 2px, transparent 2px)',
    });
    b.add(p);
    b.addMask('url(img/gradient_dark_lower_left_1.png)');
    demobox.add(b);
    return demobox;
  }

  function makePatternMask() {
    var b = Thing.classes.Box.make({w:200, h:580, backgroundColor:'#0c7436'});
    var p = Thing.classes.Pattern.make({
      pattern:'none',
      backgroundSize: '50px 50px, 50px 50px',
      backgroundPosition: '-2px -2px, -2px -2px',
      backgroundImage: 'linear-gradient(rgba(60, 60, 60, 0.4) 2px, transparent 2px), linear-gradient(90deg, rgba(60, 60, 60, 0.4) 2px, transparent 2px)',
    });
    b.add(p);
    b.add(Thing.classes.Img.make({src:'img/marilyn_mouth_square.png', x:30, y:200, w:500, opacity:0.6, filter: 'blur(2px)'}));
    b.add(Thing.classes.Img.make({src:'img/sofa_3_victorian_sofa_t.png', x:50, y:225, w:600, opacity:1}));
    b.add(Thing.classes.Img.make({src:'img/marilyn_mouth_square.png', x:20, y:150, w:450, opacity:0.6, filter: 'blur(2px)'}));
    b.add(Thing.classes.Img.make({src:'img/marilyn_mouth_square.png', x:10, y:100, w:400, opacity:0.6, filter: 'blur(2px)'}));
    b.addMask('url(img/rubens_adonis_leg_left.png)');
    return b;
  }

  function makeImageMask() {
    var b = Thing.classes.Box.make({
      w: 230,
      h: 575,
      backgroundColor: '#0c7436',
      left: '400px'
    });
    b.add(Thing.classes.Pattern.make({
      pattern:'none',
      backgroundSize: '50px 50px, 50px 50px',
      backgroundPosition: '-2px -2px, -2px -2px',
      backgroundImage: 'linear-gradient(rgba(60, 60, 60, 0.4) 2px, transparent 2px), linear-gradient(90deg, rgba(60, 60, 60, 0.4) 2px, transparent 2px)',
    }));
    b.add(Thing.classes.Img.make({
      src: 'img/rubens_adonis_leg_left.png',
      w: 200,
    }));
    b.addMask('url(img/rubens_adonis_leg_left.png)');
    return b;
  }

  function makeImageShadow() {
    var b = Thing.classes.Box.make({
      w: 200,
      h: 580,
      left: '800px'
    });
    b.add(Thing.classes.Pattern.make({
      pattern:'none',
      backgroundSize: '50px 50px, 50px 50px',
      backgroundPosition: '-2px -2px, -2px -2px',
      backgroundImage: 'linear-gradient(rgba(60, 60, 60, 0.4) 2px, transparent 2px), linear-gradient(90deg, rgba(60, 60, 60, 0.4) 2px, transparent 2px)',
      stretch: true
    }));
    b.add(Thing.classes.Img.make({
      src: 'img/rubens_adonis_leg_left.png',
      w: 200,
      filter: 'drop-shadow(10px 10px 19px rgba(0,0,0,0.7))'
    }));
    return b;
  }

  //---------------------------------------------------------

  makeBoxOfArrows();

  var FB = FunBox.make();
  FB.add(makeTenBoxes());
  FB.each( box => { box.add(makeTenLines()) } );
  FB.render();

  makeGradientMask().render()

  makePatternMask().render()
  makeImageMask().render()
  makeImageShadow().render()

  window.FB = FB;
  window.Img = Img;
});
</script>

  </body>
</html>
